# Status Bar Helper - å®Œæ•´åŠŸèƒ½å¯¦ä½œç¸½è¦½ âœ…

## ğŸ¯ å°ˆæ¡ˆæ¦‚è¿°

Status Bar Helper æ˜¯ä¸€å€‹åŠŸèƒ½è±å¯Œçš„ VS Code æ“´å……å¥—ä»¶ï¼Œæä¾›è‡ªè¨‚ç‹€æ…‹åˆ—æŒ‰éˆ•ã€è…³æœ¬åŸ·è¡Œç’°å¢ƒã€æª”æ¡ˆç¸½ç®¡æ•´åˆã€æ™ºæ…§å‚™ä»½ã€æ©Ÿå¯†ç®¡ç†ç­‰å®Œæ•´åŠŸèƒ½ã€‚ç‰ˆæœ¬å·²ç™¼å±•è‡³ **v1.8.13**ï¼Œå…·å‚™ä¼æ¥­ç´šçš„å®‰å…¨æ€§èˆ‡ç©©å®šæ€§ï¼Œä¸¦æ¡ç”¨ç¾ä»£åŒ–çš„å‰ç«¯æ¨¡çµ„åŒ–æ¶æ§‹ã€‚

## ğŸ”„ æœ€æ–°åŠŸèƒ½ï¼ˆv1.5.0 - v1.8.13ï¼‰

### v1.8.14 - Explorer Action API

- âœ… **æª”æ¡ˆç¸½ç®¡æ•´åˆ**ï¼šé€éå³éµé¸å–®åŸ·è¡Œè‡ªè¨‚å‹•ä½œ
- âœ… **Quick Pick ä»‹é¢**ï¼šå‹•æ…‹é¡¯ç¤ºæ‰€æœ‰å·²è¨»å†Šå‹•ä½œï¼Œæ”¯æ´ Codicons åœ–ç¤º
- âœ… **å¤šæª”é¸å–æ”¯æ´**ï¼šè™•ç†å–®ä¸€æª”æ¡ˆæˆ–å¤šé¸æª”æ¡ˆ
- âœ… **è‡ªå‹•æ¸…ç†æ©Ÿåˆ¶**ï¼šVM åœæ­¢æ™‚è‡ªå‹•ç§»é™¤è¨»å†Šçš„å‹•ä½œ
- âœ… **TypeScript å®Œæ•´å®šç¾©**ï¼š`ExplorerActionConfig/Handle/Context` å‹åˆ¥

### v1.8.13 - å‰ç«¯æ¨¡çµ„åŒ–é‡æ§‹å®Œæˆ

- âœ… **å‰ç«¯æ¨¡çµ„åŒ–æ¶æ§‹**ï¼šå®Œæ•´çš„ Web Components åŒ–é‡æ§‹ï¼ˆPhase 1-8ï¼‰
- âœ… **CSS æ¨¡çµ„åŒ–**ï¼šåˆ†é›¢ç‚º base.cssã€layout.cssã€components.css ç­‰æ¨¡çµ„
- âœ… **Web Components**ï¼šList Viewã€Edit Pageã€Script Storeã€Import/Exportã€Backup Managerã€Data View å…¨é¢çµ„ä»¶åŒ–
- âœ… **å¤šåœ‹èªç³»å·¥å…·**ï¼ši18n-helper.js çµ±ä¸€èªç³»ç®¡ç†ï¼ŒNLS æª¢æŸ¥å·¥å…·ç¢ºä¿ç¿»è­¯å®Œæ•´æ€§
- âœ… **æŠ€è¡“å‡ç´š**ï¼šMonaco Editor 0.53 (ESM)ã€Codicons æ›´æ–°æ©Ÿåˆ¶ã€Node.js v22 é¡å‹æ”¯æ´
- âœ… **Vite æ§‹å»ºç³»çµ±**ï¼šæ–°å¢ç¾ä»£åŒ–å‰ç«¯æ§‹å»ºå·¥å…·éˆ
- âœ… **ç¯„ä¾‹æ”¹å–„**ï¼šæ›´æ–°é è¨­è…³æœ¬ç¯„ä¾‹èˆ‡å¤šèªè¨€æç¤ºæ–‡ä»¶
- âœ… **Bug ä¿®å¾©**ï¼šVM è³‡æºé‡‹æ”¾ã€Monaco è¤‡è£½/è²¼ä¸ŠåŠŸèƒ½ã€Windows å‚™ä»½ ID ç­‰å•é¡Œä¿®å¾©

### v1.7.4 - ç¨‹å¼ç¢¼ç¯„ä¾‹å„ªåŒ–

- âœ… ä¿®æ­£ç¯„ä¾‹ç¨‹å¼ç¢¼çš„éŒ¯èª¤èˆ‡ä¸ä¸€è‡´å•é¡Œ
- âœ… æ”¹å–„è…³æœ¬åŸ·è¡Œçš„ç©©å®šæ€§

### v1.7.2 - TypeScript é¡å‹å®šç¾©å®Œæ•´åŒ–

- âœ… **å®Œæ•´ TypeScript æ”¯æ´**ï¼šæ–°å¢ `types/status-bar-helper/sbh.d.ts` æä¾›å®Œæ•´çš„ API é¡å‹å®šç¾©
- âœ… **ç¯„ä¾‹è…³æœ¬æ“´å……**ï¼šScript Store æ–°å¢æ›´å¤šå¯¦ç”¨ç¯„ä¾‹
- âœ… **è³‡æ–™æ¸…ç†æ”¹å–„**ï¼šå„ªåŒ–å„²å­˜è³‡æ–™çš„æ¸…ç†èˆ‡ç®¡ç†åŠŸèƒ½
- âœ… **åŸ·è¡Œç‹€æ…‹å„ªåŒ–**ï¼šæ”¹å–„è…³æœ¬åŸ·è¡Œç‹€æ…‹çš„å³æ™‚æ›´æ–°

### v1.7.0 - æ©Ÿå¯†å„²å­˜åŠŸèƒ½

- âœ… **SecretStorage API**ï¼šæ–°å¢ `sbh.v1.secrets` å®‰å…¨æ©Ÿå¯†å„²å­˜åŠŸèƒ½
- âœ… **ä½¿ç”¨è€…ç¢ºèªæ©Ÿåˆ¶**ï¼šæ‰€æœ‰æ©Ÿå¯†æ“ä½œéœ€ä½¿ç”¨è€…æ˜ç¢ºç¢ºèª
- âœ… **Script Store ç¯„ä¾‹**ï¼šæ–°å¢æ©Ÿå¯†ç®¡ç†ç›¸é—œçš„ç¯„ä¾‹è…³æœ¬
- âœ… **å®‰å…¨æ€§å¢å¼·**ï¼šé¿å…è…³æœ¬ä¸­ç¡¬ç·¨ç¢¼æ•æ„Ÿè³‡æ–™

### v1.6.0 - å´é‚Šæ¬„ç®¡ç†ç³»çµ±

- âœ… **SidebarManager**ï¼šå®Œæ•´çš„å´é‚Šæ¬„ç®¡ç†åŠŸèƒ½ï¼Œæ”¯æ´ HTML å…§å®¹è¼‰å…¥
- âœ… **ç”Ÿå‘½é€±æœŸç®¡ç†**ï¼šè‡ªå‹•è™•ç† open/close/replace æ“ä½œèˆ‡å›èª¿æ©Ÿåˆ¶
- âœ… **API æ•´åˆ**ï¼šé€é `sbh.v1.sidebar` æä¾›è…³æœ¬ä¸­çš„å´é‚Šæ¬„æ§åˆ¶
- âœ… **èšç„¦æ§åˆ¶**ï¼šæ”¯æ´éœé»˜è¼‰å…¥èˆ‡ä¸»å‹•èšç„¦é¡¯ç¤ºæ¨¡å¼

### v1.5.0 - æ™ºæ…§å‹å®šæ™‚å‚™ä»½

- âœ… **Smart Backup Manager**ï¼šæ™ºæ…§å‹å®šæ™‚å‚™ä»½ç³»çµ±ï¼Œæ¡ç”¨è®Šæ›´åµæ¸¬æ©Ÿåˆ¶
- âœ… **å‹•æ…‹é–“éš”èª¿æ•´**ï¼šæ ¹æ“šè®Šæ›´é »ç‡è‡ªå‹•èª¿æ•´å‚™ä»½é–“éš”ï¼ˆæœ€å° 6 å°æ™‚ï¼‰
- âœ… **åŸå­æ€§æ“ä½œ**ï¼šç¢ºä¿å‚™ä»½éç¨‹çš„å®Œæ•´æ€§èˆ‡ä¸€è‡´æ€§
- âœ… **å„²å­˜æœ€ä½³åŒ–**ï¼šåƒ…åœ¨å¯¦éš›è®Šæ›´æ™‚åŸ·è¡Œå‚™ä»½ï¼Œé¿å…é‡è¤‡å‚™ä»½

## ğŸ—ï¸ æŠ€è¡“æ¶æ§‹ç¸½è¦½

### æ ¸å¿ƒæ¨¡çµ„æ¶æ§‹

```text
Extension Host (extension.ts)
â”œâ”€â”€ Runtime & VM Management
â”‚   â”œâ”€â”€ Script Execution (Node.js VM Sandbox)
â”‚   â”œâ”€â”€ Message Bus (VM â†” Host Communication)
â”‚   â””â”€â”€ TypeScript Definitions (sbh.d.ts)
â”œâ”€â”€ Settings Panel (SettingsPanel.ts)
â”‚   â”œâ”€â”€ Webview Management
â”‚   â”œâ”€â”€ Monaco Editor Integration
â”‚   â””â”€â”€ State Synchronization
â”œâ”€â”€ Sidebar Manager (SidebarManager.ts)
â”‚   â”œâ”€â”€ Independent Webview Lifecycle
â”‚   â”œâ”€â”€ HTML Content Management
â”‚   â””â”€â”€ Focus & Close Callbacks
â”œâ”€â”€ Smart Backup Manager (SmartBackupManager.ts)
â”‚   â”œâ”€â”€ Change Detection Signature
â”‚   â”œâ”€â”€ Dynamic Interval Adjustment
â”‚   â””â”€â”€ Atomic Backup Operations
â”œâ”€â”€ Explorer Action Integration
â”‚   â”œâ”€â”€ Single Unified Entry Point (statusBarHelper.explorerAction)
â”‚   â”œâ”€â”€ Dynamic Quick Pick Menu
â”‚   â”œâ”€â”€ Auto-registration Cleanup on VM Stop
â”‚   â””â”€â”€ Multi-file Selection Support (uri/uris)
â””â”€â”€ Bridge APIs
    â”œâ”€â”€ Storage (Global/Workspace)
    â”œâ”€â”€ File Operations (Text/JSON/Binary)
    â”œâ”€â”€ Secret Storage (Secure Credentials)
    â”œâ”€â”€ Sidebar Control (Open/Close/Replace)
    â””â”€â”€ Explorer Action (Context Menu Registration)

Frontend Architecture (media/)
â”œâ”€â”€ Web Components (components/)
â”‚   â”œâ”€â”€ list-view.js - é …ç›®åˆ—è¡¨çµ„ä»¶
â”‚   â”œâ”€â”€ edit-page.js - ç·¨è¼¯é é¢çµ„ä»¶
â”‚   â”œâ”€â”€ script-store.js - è…³æœ¬å•†åº—çµ„ä»¶
â”‚   â”œâ”€â”€ import-dialog.js - åŒ¯å…¥å°è©±æ¡†
â”‚   â”œâ”€â”€ export-dialog.js - åŒ¯å‡ºå°è©±æ¡†
â”‚   â”œâ”€â”€ backup-manager.js - å‚™ä»½ç®¡ç†çµ„ä»¶
â”‚   â”œâ”€â”€ data-view.js - è³‡æ–™æª¢è¦–çµ„ä»¶
â”‚   â”œâ”€â”€ monaco-editor.js - Monaco ç·¨è¼¯å™¨åŒ…è£
â”‚   â””â”€â”€ confirmation-dialog.js - ç¢ºèªå°è©±æ¡†
â”œâ”€â”€ Utilities (utils/)
â”‚   â”œâ”€â”€ i18n-helper.js - åœ‹éš›åŒ–å·¥å…·
â”‚   â”œâ”€â”€ monaco-loader.js - Monaco å‹•æ…‹è¼‰å…¥
â”‚   â””â”€â”€ vscode-icons.js - åœ–ç¤ºå·¥å…·
â”œâ”€â”€ Styles (styles/)
â”‚   â”œâ”€â”€ base.css - åŸºç¤è®Šæ•¸èˆ‡é‡ç½®
â”‚   â”œâ”€â”€ layout.css - ç‰ˆé¢é…ç½®
â”‚   â”œâ”€â”€ components.css - çµ„ä»¶æ¨£å¼
â”‚   â”œâ”€â”€ list-view.css - åˆ—è¡¨æª¢è¦–æ¨£å¼
â”‚   â””â”€â”€ edit-page.css - ç·¨è¼¯é é¢æ¨£å¼
â””â”€â”€ Build System
    â”œâ”€â”€ Vite - ç¾ä»£åŒ–å‰ç«¯æ§‹å»º
    â”œâ”€â”€ TypeScript (media-src/) - é¡å‹å®‰å…¨é–‹ç™¼
    â””â”€â”€ ESM Monaco Editor - æ¨¡çµ„åŒ–ç·¨è¼¯å™¨
```

### API ç”Ÿæ…‹ç³»çµ±

- **v1.8.14**: æª”æ¡ˆç¸½ç®¡å³éµé¸å–®æ•´åˆ
- **v1.8.x**: å‰ç«¯æ¨¡çµ„åŒ–é‡æ§‹ã€Monaco ESMã€Vite æ§‹å»ºç³»çµ±ã€Node.js v22 æ”¯æ´
- **v1.7.x**: å®Œæ•´çš„ TypeScript æ”¯æ´èˆ‡æ©Ÿå¯†å„²å­˜
- **v1.6.x**: å´é‚Šæ¬„ç®¡ç†èˆ‡æ“´å±• API æ•´åˆ
- **v1.5.x**: æ™ºæ…§å‚™ä»½èˆ‡ä¼æ¥­ç´šè³‡æ–™ä¿è­·
- **å‘å¾Œç›¸å®¹**: æ‰€æœ‰ API è®Šæ›´å‡ç¶­æŒå‘å¾Œç›¸å®¹æ€§

## ğŸ¨ å‰ç«¯æ¨¡çµ„åŒ–é‡æ§‹ï¼ˆv1.8.xï¼‰

### Phase 1-8 å®Œæ•´å¯¦ä½œ

#### Phase 1: CSS æ¨¡çµ„åŒ–

- âœ… åˆ†é›¢ base.cssï¼ˆè®Šæ•¸èˆ‡é‡ç½®ï¼‰ã€layout.cssï¼ˆç‰ˆé¢é…ç½®ï¼‰
- âœ… å»ºç«‹ components.cssã€list-view.cssã€edit-page.css
- âœ… Codicons å­—å‹èˆ‡æ¨£å¼ç¨ç«‹ç®¡ç†

#### Phase 2: å¤šåœ‹èªç³»æ¨¡çµ„åŒ–

- âœ… å»ºç«‹ `media/utils/i18n-helper.js` çµ±ä¸€èªç³»ç®¡ç†
- âœ… æ‰€æœ‰çµ„ä»¶é€é `t(key)` å­˜å–ç¿»è­¯
- âœ… NLS æª¢æŸ¥å·¥å…· (`tools/check-nls.mjs`) ç¢ºä¿ç¿»è­¯å®Œæ•´æ€§
- âœ… ä¿®æ­£èªç³»è¦†è“‹èˆ‡è¡çªå•é¡Œ

#### Phase 3: Confirmation System

- âœ… `confirmation-dialog.js` Web Component
- âœ… éé˜»å¡å¼ç¢ºèªå°è©±æ¡†ï¼ŒPromise-based API
- âœ… æ”¯æ´æ¨™é¡Œã€è¨Šæ¯ã€ä¸»è¦/æ¬¡è¦æŒ‰éˆ•è‡ªè¨‚

#### Phase 4: Import Dialog

- âœ… `import-dialog.js` Web Component
- âœ… å°è£é è¦½ã€é¸æ“‡ã€å¥—ç”¨é‚è¼¯
- âœ… æ”¯æ´ Replace/Append èˆ‡ Skip/NewId ç­–ç•¥

#### Phase 5: Export Dialog

- âœ… `export-dialog.js` Web Component
- âœ… é …ç›®é¸æ“‡ã€JSON é è¦½ã€è¤‡è£½/å„²å­˜åŠŸèƒ½
- âœ… å®Œæ•´çš„åœ‹éš›åŒ–æ”¯æ´

#### Phase 6: Backup Manager

- âœ… `backup-manager.js` Web Component
- âœ… å‚™ä»½åˆ—è¡¨ã€é‚„åŸã€åˆªé™¤åŠŸèƒ½
- âœ… è‡ªå‹•/æ‰‹å‹•å‚™ä»½æ•´åˆ

#### Phase 7: Script Store

- âœ… `script-store.js` Web Component
- âœ… Catalog è¼‰å…¥ã€å®‰è£ã€æ›´æ–°ã€å·®ç•°æª¢è¦–
- âœ… NEW å¾½ç« ç³»çµ±èˆ‡æ‰¹æ¬¡å®‰è£

#### Phase 8: Data View

- âœ… `data-view.js` Web Component
- âœ… å„²å­˜è³‡æ–™æª¢è¦–èˆ‡ç®¡ç†
- âœ… Global/Workspace ç¯„åœåˆ‡æ›

### æŠ€è¡“ç‰¹è‰²

#### Web Components æ¶æ§‹

- è‡ªè¨‚å…ƒç´ å°è£ (`<list-view>`, `<edit-page>`, ç­‰)
- Shadow DOM éš”é›¢ï¼ˆé¸æ“‡æ€§ä½¿ç”¨ï¼‰
- ç”Ÿå‘½é€±æœŸç®¡ç† (connectedCallback, disconnectedCallback)
- äº‹ä»¶é©…å‹•é€šè¨Š

#### Monaco Editor å‡ç´š

- Monaco 0.53.0 ESM ç‰ˆæœ¬
- å‹•æ…‹è¼‰å…¥æ©Ÿåˆ¶ (`monaco-loader.js`)
- ä¿®å¾© webview è¤‡è£½/è²¼ä¸Šå•é¡Œ
- TypeScript å®šç¾©åŒæ­¥æ³¨å…¥

#### Codicons ç®¡ç†

- è‡ªå‹•æ›´æ–°è…³æœ¬ (`scripts/update-codicons.mjs`)
- åœ–ç¤ºæ¸…å–®ç”¢ç”Ÿå·¥å…·
- ç‰ˆæœ¬åŒ–å­—å‹èˆ‡ CSS ç®¡ç†

#### Vite æ§‹å»ºç³»çµ±

- `media-src/` TypeScript æºç¢¼
- `vite.config.ts` æ§‹å»ºé…ç½®
- ESM è¼¸å‡ºè‡³ `media/main.js`
- é–‹ç™¼æ¨¡å¼èˆ‡ç”Ÿç”¢å„ªåŒ–

### æ§‹å»ºæµç¨‹

```bash
# é–‹ç™¼æ¨¡å¼
npm run compile      # TypeScript (tsc) + è¤‡è£½è³‡æº
npm run watch        # ç›£çœ‹æ¨¡å¼ç·¨è­¯

# å‰ç«¯æ§‹å»ºï¼ˆå¯é¸ï¼‰
npm run build:frontend  # Vite æ§‹å»º media-src

# æ‰“åŒ…ç™¼å¸ƒ
npm run build        # vsce package
```

## ğŸ¨ UI åœ–ç¤ºåŒ–å‡ç´š

### 1. å…¨é¢æŒ‰éˆ•åœ–ç¤ºè½‰æ›

- âœ… **åˆ—è¡¨æª¢è¦–**: Run/Stop/Edit/Delete æŒ‰éˆ•æ”¹ç”¨ VS Code Codicons
- âœ… **Script Store**: View/Install/Update/Remove æŒ‰éˆ•è½‰æ›ç‚ºåœ–ç¤ºæ ¼å¼
- âœ… **ç·¨è¼¯é é¢**: Run/Stop/Save/Cancel æŒ‰éˆ•æ¡ç”¨åœ–ç¤ºè¨­è¨ˆ  
- âœ… **å„²å­˜è³‡æ–™**: Delete æŒ‰éˆ•è½‰æ›ç‚ºåƒåœ¾æ¡¶åœ–ç¤º
- âœ… **é‡æ–°æ•´ç†æŒ‰éˆ•**: è½‰æ›ç‚ºåœ–ç¤ºæ ¼å¼ä¸¦å³å°é½Š

### 2. ç‰ˆé¢é…ç½®æœ€ä½³åŒ–

- âœ… è¡¨æ ¼è¡Œé«˜ä¸€è‡´æ€§ä¿®å¾© (34px)
- âœ… æŒ‰éˆ•å°é½Šèˆ‡é–“è·çµ±ä¸€
- âœ… æ“ä½œæ¬„å¯¬åº¦é‡å°é›™åœ–ç¤ºä½ˆå±€æœ€ä½³åŒ– (60px)
- âœ… éŸ¿æ‡‰å¼è¨­è¨ˆä¿æŒ

### 3. Script Store å¢å¼·

- âœ… æ›´æ–°ç¢ºèªå°è©±æ¡†ï¼ŒåŒ…å«å·®ç•°é è¦½
- âœ… è¦–è¦ºæŒ‡ç¤ºå™¨ï¼ˆæœ‰å·®ç•°æ™‚ View åœ–ç¤ºé¡è‰²è®ŠåŒ–ï¼‰
- âœ… å®Œæ•´åœ‹éš›åŒ–æ”¯æ´ï¼ˆæ›´æ–°ç¢ºèªã€é è¦½å°è©±æ¡†ï¼‰
- âœ… **ç‹€æ…‹æ’åº**: æ–°å¢ > å¯æ›´æ–° > å·²å®‰è£ çš„å„ªå…ˆé †åº
- âœ… **Diff è¦–çª— UX é‡æ–°è¨­è¨ˆ**: åº•éƒ¨æŒ‰éˆ•ä½ˆå±€ï¼Œç§»é™¤æ¨™é¡Œåˆ—æ›´æ–°æŒ‰éˆ•
- âœ… **NEW å¾½ç« æŒ‡ç¤ºå™¨**: Script Store æŒ‰éˆ•é¡¯ç¤ºæ–°è…³æœ¬æ•¸é‡çš„å‹•æ…‹å¾½ç« 
- âœ… **å®‰è£ç¢ºèªå°è©±æ¡†**: æ‰¹æ¬¡å®‰è£å‰é¡¯ç¤ºè©³ç´°æ¸…å–®ç¢ºèª
- âœ… **ç¾ä»£åŒ–è‰²å½©ç³»çµ±**: æ¼¸å±¤èƒŒæ™¯èˆ‡ä¸»é¡Œé©é…çš„ç‹€æ…‹å¾½ç« 

## ğŸ”„ Diff è¦–çª— UX é‡æ–°è¨­è¨ˆ

### 1. åº•éƒ¨æŒ‰éˆ•å€åŸŸ

- âœ… **ç§»é™¤æ¨™é¡Œåˆ—æ›´æ–°æŒ‰éˆ•**: æ¶ˆé™¤ä»¤äººå›°æƒ‘çš„ä¸Šæ–¹æŒ‰éˆ•é…ç½®
- âœ… **æ–°å¢åº•éƒ¨æ“ä½œå€åŸŸ**: é¡ä¼¼æ¨™æº–ç¢ºèªå°è©±æ¡†çš„ä½ˆå±€
- âœ… **å–æ¶ˆ/æ›´æ–°æŒ‰éˆ•**: ä½æ–¼è¦–çª—åº•éƒ¨ï¼Œæä¾›æ›´ç›´è§€çš„æ“ä½œæµç¨‹
- âœ… **å¤šåœ‹èªç³»æ”¯æ´**: ç¢ºä¿æ‰€æœ‰æŒ‰éˆ•æ­£ç¢ºé¡¯ç¤ºæœ¬åœ°åŒ–æ–‡å­—

### 2. ä½¿ç”¨è€…é«”é©—æ”¹å–„

- âœ… **ä¸€è‡´çš„å°è©±æ¡†é«”é©—**: Diff è¦–çª—ç¾åœ¨æ„Ÿè¦ºåƒæ•´åˆçš„ç¢ºèªå°è©±æ¡†
- âœ… **æ¶ˆé™¤åŒæ™‚è·³å‡ºè¦–çª—å•é¡Œ**: ä¸å†æœ‰ diff è¦–çª—å’Œæç¤ºè¦–çª—åŒæ™‚å‡ºç¾çš„å›°æ“¾
- âœ… **æ›´å¥½çš„æ±ºç­–æµç¨‹**: ä½¿ç”¨è€…å¯ä»¥å®Œæ•´æª¢è¦–å·®ç•°å¾Œåœ¨åº•éƒ¨åšæ±ºå®š

## âœ‚ï¸ ç·¨è¼¯é é¢ç°¡åŒ–

### 1. Tags æ¬„ä½ç§»é™¤

- âœ… å®Œå…¨ç§»é™¤ç·¨è¼¯é é¢çš„ Tags è¼¸å…¥æ¬„ä½
- âœ… ç§»é™¤ç›¸é—œçš„ JavaScript è™•ç†é‚è¼¯
- âœ… æ¸…ç†ä¸å¿…è¦çš„ CSS è¦å‰‡
- âœ… ä¿ç•™åˆ—è¡¨æª¢è¦–å’Œ Script Store ä¸­çš„ tags é¡¯ç¤º

### 2. å°ˆæ³¨æ ¸å¿ƒåŠŸèƒ½

- âœ… ç°¡åŒ–ç·¨è¼¯ä»‹é¢ç‚ºå››å€‹æ ¸å¿ƒæ¬„ä½ï¼šåœ–ç¤ºã€æ¨™ç±¤ã€å·¥å…·æç¤ºã€è…³æœ¬
- âœ… åœ–ç¤ºåŒ–æ“ä½œæŒ‰éˆ•æä¾›æ›´ç›´è§€çš„æ“ä½œé«”é©—
- âœ… ç§»é™¤è®Šæ›´åµæ¸¬ä¸­çš„ tags æ¯”è¼ƒé‚è¼¯

## ğŸ”§ æŠ€è¡“æ”¹é€²

### ç„¡éšœç¤™åŠŸèƒ½ç¶­æŒ

- âœ… æ‰€æœ‰åœ–ç¤ºæŒ‰éˆ•ä¿æŒå®Œæ•´çš„ `title` å’Œ `aria-label` å±¬æ€§
- âœ… éµç›¤å°èˆªæ”¯æ´
- âœ… è¢å¹•é–±è®€å™¨ç›¸å®¹æ€§

### CSS æœ€ä½³åŒ–

- âœ… çµ±ä¸€çš„åœ–ç¤ºæŒ‰éˆ•æ¨£å¼ (22-28px)
- âœ… ä¸€è‡´çš„æ‡¸åœæ•ˆæœå’Œç‹€æ…‹æŒ‡ç¤º
- âœ… æ·±æ·ºè‰²ä¸»é¡Œå®Œå…¨æ”¯æ´

### JavaScript æ¸…ç†

- âœ… ç§»é™¤ tags ç›¸é—œçš„äº‹ä»¶ç›£è½å™¨
- âœ… ç°¡åŒ–å„²å­˜é‚è¼¯ï¼Œç§»é™¤ tags è™•ç†
- âœ… æ¸…ç†è®Šæ›´åµæ¸¬å‡½æ•¸

---

## é€²éšåŒ¯å…¥/åŒ¯å‡ºåŠŸèƒ½å¯¦ä½œå®Œæˆ âœ…

### ğŸ¯ åŠŸèƒ½æ¦‚è¦½

é€™æ¬¡æˆåŠŸå¯¦ä½œäº†å®Œæ•´çš„**é€²éšåŒ¯å…¥/åŒ¯å‡ºåŠŸèƒ½**ï¼Œç‚º Status Bar Helper æ“´å……å¥—ä»¶æä¾›å¼·å¤§çš„è¨­å®šç®¡ç†èƒ½åŠ›ã€‚

## ğŸ“¦ å¯¦ä½œå…§å®¹

### 1. æ ¸å¿ƒé‚è¼¯ (`src/utils/importExport.ts`)

- âœ… `parseAndValidate` - åš´æ ¼ JSON è§£æèˆ‡é©—è­‰
- âœ… `estimateSize` - è³‡æ–™å¤§å°ä¼°ç®—
- âœ… `diff` - é …ç›®å·®ç•°æ¯”è¼ƒ
- âœ… `applyImport` - æ™ºæ…§åˆä½µèˆ‡è¡çªè™•ç†
- âœ… `exportSelection` - é¸æ“‡æ€§åŒ¯å‡º

### 2. å¾Œç«¯æ©‹æ¥ (`src/extension.ts`)

- âœ… `importPreview` - åŒ¯å…¥é è¦½èˆ‡é©—è­‰
- âœ… `exportPreview` - åŒ¯å‡ºé è¦½èˆ‡ JSON ç”¢ç”Ÿ
- âœ… `applyImport` - å¯¦éš›å¥—ç”¨åŒ¯å…¥æ“ä½œ
- âœ… `loadImportFile` - æª”æ¡ˆè¼‰å…¥æ©‹æ¥
- âœ… `saveExportToFile` - æª”æ¡ˆå„²å­˜æ©‹æ¥

### 3. å‰ç«¯ä»‹é¢ (`media/settings.html`)

- âœ… æ¨¡æ…‹å°è©±æ¡†è¨­è¨ˆ (éŸ¿æ‡‰å¼ã€æ·±æ·ºè‰²ä¸»é¡Œ)
- âœ… åˆ†é å¼ä»‹é¢ (åŒ¯å…¥/åŒ¯å‡º)
- âœ… é è¦½è¡¨æ ¼ (checkbox ç¬¬ä¸€æ¬„ã€ç‹€æ…‹é¡¯ç¤º)
- âœ… åˆä½µç­–ç•¥é¸æ“‡ (Replace/Append)
- âœ… è¡çªè™•ç†æ©Ÿåˆ¶ (Skip/NewId)
- âœ… æª”æ¡ˆè¼‰å…¥/å„²å­˜åŠŸèƒ½
- âœ… å‰ªè²¼ç°¿æ“ä½œæ”¯æ´

### 4. å¾Œç«¯è¨Šæ¯è™•ç† (`src/SettingsPanel.ts`)

- âœ… æ–°å¢æ‰€æœ‰ Import/Export ç›¸é—œè¨Šæ¯è™•ç†å™¨
- âœ… éŒ¯èª¤è™•ç†èˆ‡ä½¿ç”¨è€…å›é¥‹
- âœ… è‡ªå‹•é‡æ–°æ•´ç†ç‹€æ…‹åˆ—
- âœ… æª”æ¡ˆå°è©±æ¡†æ•´åˆ

### 5. å¤šèªç³»æ”¯æ´

- âœ… ç¹é«”ä¸­æ–‡ç¿»è­¯ (`media/nls.zh-tw.json`)
- âœ… è‹±æ–‡ç¿»è­¯ (`media/nls.en.json`)
- âœ… å‹•æ…‹èªè¨€åˆ‡æ›æ”¯æ´

## ğŸ”§ æŠ€è¡“ç‰¹è‰²

### æ¬„ä½ä¿ç•™èˆ‡é †åº

- åš´æ ¼ç¶­æŒ JSON æ¬„ä½é †åº
- ä¿ç•™æœªçŸ¥æ¬„ä½ä¸éºå¤±
- å‹åˆ¥å®‰å…¨çš„é©—è­‰æ©Ÿåˆ¶

### æ™ºæ…§è¡çªè™•ç†

- **Replace** æ¨¡å¼ï¼šæ¸…é™¤ç¾æœ‰é …ç›®å¾ŒåŒ¯å…¥
- **Append** æ¨¡å¼ï¼šé™„åŠ åˆ°ç¾æœ‰é …ç›®
- **Skip** ç­–ç•¥ï¼šè·³éè¡çªé …ç›®
- **NewId** ç­–ç•¥ï¼šç”¢ç”Ÿæ–°çš„å‘½ä»¤ ID

### é è¦½èˆ‡å®‰å…¨

- åŒ¯å…¥å‰å®Œæ•´é è¦½è®Šæ›´
- ç‹€æ…‹æ¨™ç¤ºï¼šæ–°å¢/å·²å­˜åœ¨/è¡çª/è·³é
- é¸æ“‡æ€§å¥—ç”¨åŠŸèƒ½
- å®Œæ•´éŒ¯èª¤è™•ç†

### ä½¿ç”¨è€…é«”é©—

- éŸ¿æ‡‰å¼è¨­è¨ˆé©æ‡‰å„ç¨®è¢å¹•
- æ·±æ·ºè‰²ä¸»é¡Œè‡ªå‹•é©æ‡‰
- ç›´è§€çš„æ“ä½œæµç¨‹
- å³æ™‚å›é¥‹èˆ‡ç‹€æ…‹æ›´æ–°

## ğŸ”— Explorer Action APIï¼ˆv1.8.14+ï¼‰

### æ ¸å¿ƒç‰¹æ€§

- **å–®ä¸€å…¥å£é»**: ä½¿ç”¨è€…åœ¨æª”æ¡ˆç¸½ç®¡å³éµé¸å–®çœ‹åˆ°å–®ä¸€ã€ŒStatus Bar Helperã€é¸é …
- **Quick Pick ä»‹é¢**: é»æ“Šå¾Œé¡¯ç¤ºæ‰€æœ‰å·²è¨»å†Šå‹•ä½œçš„å‹•æ…‹é¸å–®
- **Codicons æ”¯æ´**: åœ¨æè¿°ä¸­ä½¿ç”¨ `$(icon)` èªæ³•é¡¯ç¤ºåœ–ç¤º
- **å¤šæª”è™•ç†**: è‡ªå‹•è™•ç†å–®ä¸€æª”æ¡ˆ (ctx.uri) æˆ–å¤šé¸æª”æ¡ˆ (ctx.uris)
- **è‡ªå‹•æ¸…ç†**: VM åœæ­¢æ™‚è‡ªå‹•ç§»é™¤è©² VM è¨»å†Šçš„æ‰€æœ‰å‹•ä½œ

### API ç¯„ä¾‹

```typescript
// åŸºæœ¬ä½¿ç”¨
await sbh.v1.explorerAction.register({
  description: '$(info) Show File Info',
  handler: async (ctx) => {
    vscode.window.showInformationMessage(`File: ${ctx.uri?.fsPath}`);
  }
});

// å¤šæª”é¸å–
await sbh.v1.explorerAction.register({
  description: '$(rocket) Batch Process Files',
  handler: async (ctx) => {
    const files = ctx.uris || (ctx.uri ? [ctx.uri] : []);
    for (const fileUri of files) {
      // è™•ç†æ¯å€‹æª”æ¡ˆ
    }
  }
});
```

## ğŸ¨ UI/UX è¨­è¨ˆ

### æ¨¡æ…‹å°è©±æ¡†

- ç½®ä¸­å½ˆå‡ºè¨­è¨ˆ
- æœ€å¤§å¯¬åº¦ 1000pxï¼Œé«˜åº¦ 90%
- é—œé–‰æŒ‰éˆ•èˆ‡é»æ“Šå¤–éƒ¨é—œé–‰

### åˆ†é è¨­è¨ˆ

- åŒ¯å…¥/åŒ¯å‡ºåˆ†é åˆ‡æ›
- æ¸…æ¥šçš„è¦–è¦ºåˆ†éš”
- æ´»å‹•ç‹€æ…‹æŒ‡ç¤º

### é è¦½è¡¨æ ¼

- checkbox ä½œç‚ºç¬¬ä¸€æ¬„
- é¡¯ç¤ºå¿…è¦æ¬„ä½ï¼štextã€commandã€tooltipã€sizeã€statusã€reason
- æ‡¸åœæ•ˆæœèˆ‡é¸æ“‡ç‹€æ…‹

### æ“ä½œæŒ‰éˆ•

- æ˜ç¢ºçš„æ“ä½œæµç¨‹å¼•å°
- ç¦ç”¨ç‹€æ…‹é˜²æ­¢èª¤æ“ä½œ
- è¦–è¦ºå›é¥‹èˆ‡è¼‰å…¥ç‹€æ…‹

## ğŸ“‹ ä½¿ç”¨æµç¨‹

### åŒ¯å…¥æµç¨‹

1. é»æ“Šã€ŒAdvanced I/Eã€æŒ‰éˆ•
2. åˆ‡æ›åˆ°ã€ŒåŒ¯å…¥ã€åˆ†é 
3. è²¼ä¸Š JSON æˆ–è¼‰å…¥æª”æ¡ˆ
4. é¸æ“‡åˆä½µç­–ç•¥èˆ‡è¡çªè™•ç†
5. é»æ“Šã€Œé è¦½è®Šæ›´ã€
6. æª¢è¦–é è¦½è¡¨æ ¼ä¸¦é¸æ“‡é …ç›®
7. é»æ“Šã€Œå¥—ç”¨åŒ¯å…¥ã€å®Œæˆ

### åŒ¯å‡ºæµç¨‹

1. é»æ“Šã€ŒAdvanced I/Eã€æŒ‰éˆ•
2. åˆ‡æ›åˆ°ã€ŒåŒ¯å‡ºã€åˆ†é 
3. é¸æ“‡è¦åŒ¯å‡ºçš„é …ç›®
4. é»æ“Šã€Œç”¢ç”Ÿ JSONã€
5. è¤‡è£½åˆ°å‰ªè²¼ç°¿æˆ–å„²å­˜æª”æ¡ˆ

## ğŸ§ª æ¸¬è©¦ç‹€æ…‹

- âœ… æ ¸å¿ƒé‚è¼¯ç·¨è­¯ç„¡éŒ¯èª¤
- âœ… TypeScript å‹åˆ¥æª¢æŸ¥é€šé
- âœ… æ¨¡çµ„è¼‰å…¥æ¸¬è©¦æˆåŠŸ
- âœ… åŒ¯å‡ºåŠŸèƒ½é©—è­‰å®Œæˆ
- ğŸ”„ å®Œæ•´æ•´åˆæ¸¬è©¦é€²è¡Œä¸­

## ğŸš€ ä¸‹ä¸€æ­¥

åŠŸèƒ½å·²å®Œæ•´å¯¦ä½œï¼Œå¯ä»¥ï¼š

1. åœ¨ VS Code ä¸­æ¸¬è©¦æ“´å……å¥—ä»¶
2. é©—è­‰æ‰€æœ‰æ“ä½œæµç¨‹
3. æ”¶é›†ä½¿ç”¨è€…å›é¥‹
4. æº–å‚™ç™¼å¸ƒæ–°ç‰ˆæœ¬

---

**å¯¦ä½œå®Œæˆæ—¥æœŸï¼š** 2025å¹´08æœˆ15æ—¥  
**ä¸»è¦é–‹ç™¼è€…ï¼š** GitHub Copilot  
**åŠŸèƒ½ç‹€æ…‹ï¼š** âœ… å®Œæˆä¸¦å¯ç”¨

---

## Script Store Phase 1 & Enhancements (Aug 2025)

### Phase 1 åˆç‰ˆ

- æœ¬åœ° catalog ä¾†æºï¼š`media/script-store.defaults.<locale>.json`
- ç‹€æ…‹è¨ˆç®—ï¼šinstalled / update / newï¼ˆä»¥ command + scriptHash + text/tooltip/tags æ¯”å°ï¼‰
- å–®é …å®‰è£èˆ‡ï¼ˆåˆç‰ˆï¼‰æ‰¹æ¬¡å®‰è£
- æ©‹æ¥ï¼š`scriptStore.catalog`ã€`install`ã€`bulkInstall`ã€`diff`ï¼ˆå¾Œç«¯å·®ç•°è³‡æ–™ï¼‰

### å¼·åŒ–ï¼ˆ2025-08ï¼‰

- æ‰¹æ¬¡å®‰è£æ”¹ç‚ºåŸå­æ“ä½œï¼ˆå¤±æ•—è‡ªå‹•å›æ»¾ snapshotï¼‰
- æ–°å¢ `diff` å¾Œç«¯ï¼šæä¾› before/afterï¼ˆscript/text/tooltip/tagsï¼‰
- Webview Script Store Modalï¼š
  - åŠ å…¥å³å´ Diff Paneï¼ˆæ¬„ä½ç´šè®Šæ›´æ¨™ç¤º + Script side-by-side ç°¡æ˜“è¡Œå·®ç•°ï¼‰
  - 400 è¡Œä»¥ä¸Šé è¨­æ‘ºç–Šï¼Œæä¾› Expand å±•é–‹
  - æ¯åˆ—æ–°å¢ View æŒ‰éˆ•å³æ™‚è¼‰å…¥ diff
  - å®‰è£ / æ‰¹æ¬¡å®‰è£ Loading ç‹€æ…‹ã€æŒ‰éˆ•åœç”¨ã€è¿·ä½  spinner
  - æ‰¹æ¬¡çµæœæ‘˜è¦ï¼ˆæˆåŠŸ / å¤±æ•—è¨ˆæ•¸ï¼‰
  - æ¬„ä½è®Šå‹•é«˜äº®ï¼ˆText / Tooltip / Tagsï¼‰

### å¾ŒçºŒè¦åŠƒï¼ˆæœªå¯¦ä½œï¼‰

- Remote catalog fetchï¼ˆETag å¿«å–ï¼‰
- `scriptUrl` å»¶å¾Œè¼‰å…¥ & å¤§è…³æœ¬ diff æ‘ºç–Šæœ€ä½³åŒ–
- æ›´ç²¾ç´°çš„è¡Œç´š diffï¼ˆLCS + é«˜äº® tokenï¼‰
- å®‰è£å‰å·®ç•°å¤šé¸å¥—ç”¨ï¼ˆpartial fields ç›®å‰ç­–ç•¥ï¼šå…¨éƒ¨è¦†è“‹ï¼‰
- Bridge æ¸¬è©¦ï¼ˆrollbackã€diff æ­£ç¢ºæ€§ï¼‰èˆ‡å®‰å…¨æƒæåŠ å¼·

### é¢¨éšªæ§ç®¡æ‘˜è¦

- æ‰¹æ¬¡å®‰è£ï¼šä»»ä½•é …å¤±æ•— â†’ é‚„åŸ snapshot â†’ å›å‚³éŒ¯èª¤
- script å®‰å…¨æª¢æŸ¥ï¼šé•·åº¦ä¸Šé™ã€å°é– `eval(` / `new Function` / å¯ç–‘ `process.env` dump pattern

### ä½¿ç”¨è€…åƒ¹å€¼

- åœ¨å®‰è£å‰å³å¯è¦–è¦ºåŒ–è®Šæ›´å·®ç•°ï¼Œé™ä½è¦†è“‹è…³æœ¬é¢¨éšª
- åŸå­æ‰¹æ¬¡æå‡ä¸€è‡´æ€§èˆ‡å¯é æ¸¬æ€§
- é ç•™æ“´å……ç©ºé–“ï¼ˆRemote / Lazy / Rich Diffï¼‰

### Remote Catalog & Locale Refactor (Aug 2025 Late)

- Remote-first catalog loading (GitHub raw) with 3s timeout / 256KB limit, fallback to packaged JSON.
- Unified locale detection (`vscode.env.language`): only `zh-tw` / `zh-hant` â†’ Traditional Chinese; others â†’ English.
- Removed legacy inline `i18n()` fallback; consolidated text refresh via `updateScriptStoreTexts()`.
- Added in-memory 5 min cache layer (structure: { at, entries }) to avoid repeated network calls; future ETag planned.
- Fixed English catalog JSON formatting (first entry script key) causing parse failure & empty Script Store.
- Refactored sync `loadLocalCatalog` â†’ async `loadCatalog` (remote + cache + local) shared across catalog / diff / install.
- Strengthened failure resilience: remote timeout / parse errors downgrade gracefully instead of blank UI.
- Maintained security filters for remote scripts (eval/new Function/process.env mass access rejection).
